<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>Den</title>
  <link rel="stylesheet" href="/vendor/xterm.css">
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <!-- ログイン画面 -->
  <div id="login-screen" class="screen">
    <div class="login-box">
      <h1>Den</h1>
      <p class="login-subtitle">Personal Workstation</p>
      <form id="login-form">
        <input type="password" id="password-input" placeholder="Password" autocomplete="current-password">
        <button type="submit">Enter</button>
      </form>
      <p id="login-error" class="error" hidden>Incorrect password</p>
    </div>
  </div>

  <!-- メイン画面 -->
  <div id="main-screen" class="screen" hidden data-1p-ignore>
    <!-- タブバー -->
    <div id="tab-bar">
      <button class="tab active" data-tab="terminal">Terminal</button>
      <button class="tab" data-tab="claude">Claude</button>
      <button class="tab" data-tab="filer">Files</button>
      <div class="tab-spacer"></div>
      <button id="settings-btn" class="tab-icon-btn" title="Settings">&#9881;</button>
    </div>

    <!-- ターミナル -->
    <div id="terminal-pane" class="pane">
      <div id="terminal-container"></div>
    </div>

    <!-- Claude -->
    <div id="claude-pane" class="pane" hidden>
      <div class="claude-layout">
        <!-- サイドバー -->
        <div class="claude-sidebar">
          <button id="claude-new-session" class="claude-new-btn">+ New Session</button>
          <div id="claude-session-list" class="claude-sessions"></div>
          <div class="sidebar-divider"></div>
          <div class="sidebar-section-label">History</div>
          <div id="claude-history-list" class="claude-history"></div>
        </div>
        <!-- メインエリア -->
        <div class="claude-main">
          <div id="claude-header" class="claude-header"></div>
          <div id="claude-messages" class="claude-messages"></div>
          <div class="claude-input-area">
            <textarea id="claude-input" class="claude-input" placeholder="Message..." rows="3"></textarea>
            <button id="claude-send" class="claude-send-btn">Send</button>
          </div>
        </div>
      </div>
    </div>

    <!-- ファイラ -->
    <div id="filer-pane" class="pane" hidden>
      <div class="filer-layout">
        <!-- サイドバー: ツリービュー -->
        <div class="filer-sidebar">
          <div class="filer-toolbar">
            <button id="filer-new-file" class="filer-tool-btn" title="New File">+&#128196;</button>
            <button id="filer-new-folder" class="filer-tool-btn" title="New Folder">+&#128193;</button>
            <button id="filer-upload" class="filer-tool-btn" title="Upload">&#8593;</button>
            <button id="filer-refresh" class="filer-tool-btn" title="Refresh">&#8635;</button>
          </div>
          <div class="filer-search">
            <input type="text" id="filer-search-input" placeholder="Search files..." />
          </div>
          <div id="filer-tree" class="filer-tree"></div>
        </div>
        <!-- メインエリア: エディタ -->
        <div class="filer-main">
          <div id="filer-tabs" class="filer-tabs"></div>
          <div id="filer-editor" class="filer-editor">
            <div class="filer-welcome">
              <p>Select a file to edit</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- アップロードモーダル -->
    <div id="filer-upload-modal" class="modal" hidden>
      <div class="modal-content">
        <h3>Upload File</h3>
        <div class="modal-section">
          <label>Destination</label>
          <input type="text" id="upload-dest" class="settings-input" readonly />
        </div>
        <div class="modal-section">
          <label>File</label>
          <input type="file" id="upload-file-input" />
        </div>
        <div class="modal-actions">
          <button id="upload-cancel" class="modal-btn">Cancel</button>
          <button id="upload-submit" class="modal-btn primary">Upload</button>
        </div>
      </div>
    </div>

    <!-- 検索結果モーダル -->
    <div id="filer-search-modal" class="modal" hidden>
      <div class="modal-content modal-content-wide">
        <h3>Search Results</h3>
        <div id="filer-search-results" class="filer-search-results"></div>
        <div class="modal-actions">
          <button id="search-close" class="modal-btn">Close</button>
        </div>
      </div>
    </div>

    <!-- 新規セッションモーダル -->
    <div id="claude-modal" class="modal" hidden>
      <div class="modal-content">
        <h3>New Claude Session</h3>
        <div class="modal-section">
          <label>Connection</label>
          <div id="modal-connections" class="modal-connections">
            <button class="conn-btn active" data-conn="local">Local</button>
          </div>
        </div>
        <div class="modal-section">
          <label>Working Directory</label>
          <div id="modal-dir-browser" class="dir-browser">
            <div class="dir-path">
              <button id="dir-up" class="dir-up-btn">..</button>
              <input type="text" id="dir-path-input" class="dir-path-input" placeholder="Type path (e.g. D:\)" />
              <button id="dir-go" class="dir-up-btn">Go</button>
            </div>
            <div id="dir-list" class="dir-list"></div>
          </div>
        </div>
        <div class="modal-section">
          <label>Prompt</label>
          <textarea id="modal-prompt" class="modal-prompt" placeholder="What would you like Claude to do?" rows="3"></textarea>
        </div>
        <div class="modal-actions">
          <button id="modal-cancel" class="modal-btn">Cancel</button>
          <button id="modal-start" class="modal-btn primary">Start</button>
        </div>
      </div>
    </div>

    <!-- 設定モーダル -->
    <div id="settings-modal" class="modal" hidden>
      <div class="modal-content">
        <h3>Settings</h3>
        <div class="modal-section">
          <label>Font Size</label>
          <input type="number" id="setting-font-size" class="settings-input" min="8" max="32" value="14">
        </div>
        <div class="modal-section">
          <label>Terminal Scrollback</label>
          <input type="number" id="setting-scrollback" class="settings-input" min="100" max="50000" value="1000">
        </div>
        <div class="modal-section">
          <label>Default Working Directory</label>
          <input type="text" id="setting-default-dir" class="settings-input" placeholder="~ (default)">
        </div>
        <div class="modal-section">
          <label>Keybar Buttons</label>
          <div id="keybar-editor" class="keybar-editor">
            <div id="keybar-btn-list" class="keybar-btn-list"></div>
            <div class="keybar-editor-actions">
              <button id="keybar-add-btn" class="modal-btn" type="button">Add Button</button>
              <button id="keybar-reset-btn" class="modal-btn" type="button">Reset to Default</button>
            </div>
            <div id="keybar-add-form" class="keybar-add-form" hidden>
              <div class="keybar-form-row">
                <label>Label</label>
                <input type="text" id="keybar-new-label" class="settings-input" placeholder="e.g. Tab" maxlength="8">
              </div>
              <div class="keybar-form-row">
                <label>Send</label>
                <select id="keybar-preset-select" class="settings-input">
                  <option value="">-- Custom --</option>
                </select>
                <input type="text" id="keybar-new-send" class="settings-input" placeholder="e.g. \t or literal text">
              </div>
              <div class="keybar-form-row">
                <label>
                  <input type="checkbox" id="keybar-new-modifier"> Modifier key (Ctrl/Alt)
                </label>
                <select id="keybar-new-modkey" class="settings-input" hidden>
                  <option value="ctrl">Ctrl</option>
                  <option value="alt">Alt</option>
                </select>
              </div>
              <div class="keybar-form-actions">
                <button id="keybar-add-confirm" class="modal-btn primary" type="button">Add</button>
                <button id="keybar-add-cancel" class="modal-btn" type="button">Cancel</button>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-actions">
          <button id="settings-cancel" class="modal-btn">Cancel</button>
          <button id="settings-save" class="modal-btn primary">Save</button>
        </div>
      </div>
    </div>

    <!-- キーバー (タッチ用) -->
    <div id="keybar"></div>
  </div>

  <script src="/vendor/codemirror.js"></script>
  <script src="/vendor/xterm.js"></script>
  <script src="/vendor/xterm-addon-fit.js"></script>
  <script src="/vendor/xterm-addon-webgl.js"></script>
  <script src="/vendor/xterm-addon-canvas.js"></script>
  <script src="/js/auth.js"></script>
  <script src="/js/settings.js"></script>
  <script src="/js/session-history.js"></script>
  <script src="/js/terminal.js"></script>
  <script src="/js/keybar.js"></script>
  <script src="/js/claude-parser.js"></script>
  <script src="/js/claude-session.js"></script>
  <script src="/js/claude.js"></script>
  <script src="/js/filer-tree.js"></script>
  <script src="/js/filer-editor.js"></script>
  <script src="/js/filer.js"></script>
  <script src="/js/app.js"></script>
</body>
</html>
